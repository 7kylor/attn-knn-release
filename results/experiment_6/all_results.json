{
  "config": {
    "seed": 42,
    "embed_dim": 256,
    "num_heads": 4,
    "epochs": 20,
    "k_train": 16,
    "k_eval": 16,
    "mixup_alpha": 0.4,
    "contrastive_weight": 0.5
  },
  "main_results": {
    "Uniform kNN": {
      "accuracy": 0.8557,
      "f1_macro": 0.8557510259539386,
      "nll": 2.027548967931715,
      "ece": 0.13360001747608186
    },
    "Distance kNN": {
      "accuracy": 0.8555,
      "f1_macro": 0.8555391165548822,
      "nll": 2.027504575572889,
      "ece": 0.1168636860489845
    },
    "Attn-KNN (Ours)": {
      "accuracy": 0.8548,
      "f1_macro": 0.8546870182289448,
      "nll": 2.057790088317003,
      "ece": 0.1359142047345638
    },
    "Attn-KNN + TTA": {
      "accuracy": 0.8554,
      "f1_macro": 0.8562581744025504,
      "nll": 0.9305883055183422,
      "ece": 0.03789322406053545
    },
    "Attn-KNN + k-Ensemble": {
      "accuracy": 0.8546,
      "f1_macro": 0.8545031460762941,
      "nll": 2.0441200899256424,
      "ece": 0.13612075431048873
    },
    "CNN (Upper Bound)": {
      "accuracy": 0.9497,
      "f1_macro": 0.9496729127953609,
      "nll": 0.24715362915063788,
      "ece": 0.072619786554575
    }
  },
  "k_sweep": {
    "1": {
      "uniform": {
        "accuracy": 0.8538,
        "f1_macro": 0.8538560443738927,
        "nll": 2.3307768111317695,
        "ece": 0.1462
      },
      "distance": {
        "accuracy": 0.8538,
        "f1_macro": 0.8538560443738927,
        "nll": 2.3307768111317695,
        "ece": 0.1462
      },
      "attention": {
        "accuracy": 0.8538,
        "f1_macro": 0.8538560443738927,
        "nll": 2.3307768111317695,
        "ece": 0.1462
      }
    },
    "3": {
      "uniform": {
        "accuracy": 0.856,
        "f1_macro": 0.8560045795511446,
        "nll": 2.1632401143051454,
        "ece": 0.13303333210647103
      },
      "distance": {
        "accuracy": 0.856,
        "f1_macro": 0.8559993995544424,
        "nll": 2.163244617792832,
        "ece": 0.13122857689261436
      },
      "attention": {
        "accuracy": 0.8549,
        "f1_macro": 0.8548757058912084,
        "nll": 2.174116059604631,
        "ece": 0.13737985087633128
      }
    },
    "5": {
      "uniform": {
        "accuracy": 0.8557,
        "f1_macro": 0.8557563699872356,
        "nll": 2.1255985156982207,
        "ece": 0.13242000153064726
      },
      "distance": {
        "accuracy": 0.8555,
        "f1_macro": 0.8555296328407019,
        "nll": 2.125581693041967,
        "ece": 0.12267483727335927
      },
      "attention": {
        "accuracy": 0.8548,
        "f1_macro": 0.854731691020787,
        "nll": 2.1414361628484446,
        "ece": 0.13606963424682617
      }
    },
    "10": {
      "uniform": {
        "accuracy": 0.8553,
        "f1_macro": 0.8553600355772275,
        "nll": 2.06365039728768,
        "ece": 0.020500006747245787
      },
      "distance": {
        "accuracy": 0.8553,
        "f1_macro": 0.8553319813041547,
        "nll": 2.06365013065009,
        "ece": 0.11681985593438149
      },
      "attention": {
        "accuracy": 0.8542,
        "f1_macro": 0.854099052955404,
        "nll": 2.088727982979951,
        "ece": 0.13660006787180898
      }
    },
    "20": {
      "uniform": {
        "accuracy": 0.8554,
        "f1_macro": 0.8554294251703523,
        "nll": 2.004815894871852,
        "ece": 0.029270009177923204
      },
      "distance": {
        "accuracy": 0.8554,
        "f1_macro": 0.8554190302449305,
        "nll": 2.0047560555164563,
        "ece": 0.11057361044883732
      },
      "attention": {
        "accuracy": 0.8545,
        "f1_macro": 0.8543748306201859,
        "nll": 2.0381573163613305,
        "ece": 0.13610893287658693
      }
    },
    "50": {
      "uniform": {
        "accuracy": 0.8558,
        "f1_macro": 0.8557816508492129,
        "nll": 1.902222163434598,
        "ece": 0.13555165864527222
      },
      "distance": {
        "accuracy": 0.8558,
        "f1_macro": 0.855771460425613,
        "nll": 1.9020591516230156,
        "ece": 0.10948416050970552
      },
      "attention": {
        "accuracy": 0.8542,
        "f1_macro": 0.854059576481969,
        "nll": 1.9481271989680462,
        "ece": 0.13625946592390537
      }
    }
  },
  "noise_robustness": {
    "0.0": {
      "uniform": {
        "accuracy": 0.8557,
        "f1_macro": 0.8557510259539386,
        "nll": 2.027548967931715,
        "ece": 0.13360001747608186
      },
      "distance": {
        "accuracy": 0.8555,
        "f1_macro": 0.8555391165548822,
        "nll": 2.027504575572889,
        "ece": 0.1168636860489845
      },
      "attention": {
        "accuracy": 0.8548,
        "f1_macro": 0.8546870182289448,
        "nll": 2.057790088317003,
        "ece": 0.1359142047345638
      }
    },
    "0.1": {
      "uniform": {
        "accuracy": 0.8557,
        "f1_macro": 0.8557419592820334,
        "nll": 1.8767070912072321,
        "ece": 0.04945624440908436
      },
      "distance": {
        "accuracy": 0.8557,
        "f1_macro": 0.8557321076738544,
        "nll": 1.8766936755809085,
        "ece": 0.046855152225494384
      },
      "attention": {
        "accuracy": 0.8505,
        "f1_macro": 0.8504251520964992,
        "nll": 1.9340883635474073,
        "ece": 0.0727155107229948
      }
    },
    "0.2": {
      "uniform": {
        "accuracy": 0.8556,
        "f1_macro": 0.8556644968218841,
        "nll": 1.7485733826986736,
        "ece": 0.08162499729394913
      },
      "distance": {
        "accuracy": 0.8554,
        "f1_macro": 0.8554416657125532,
        "nll": 1.7485610728754746,
        "ece": 0.08105606296658514
      },
      "attention": {
        "accuracy": 0.8516,
        "f1_macro": 0.851490666341663,
        "nll": 1.8175033785920531,
        "ece": 0.12675312416255474
      }
    },
    "0.3": {
      "uniform": {
        "accuracy": 0.8563,
        "f1_macro": 0.8563514088300422,
        "nll": 1.6480005039593653,
        "ece": 0.1650437496840954
      },
      "distance": {
        "accuracy": 0.8563,
        "f1_macro": 0.8563396111960009,
        "nll": 1.6479227437935078,
        "ece": 0.16493365953564643
      },
      "attention": {
        "accuracy": 0.8469,
        "f1_macro": 0.8467057857813962,
        "nll": 1.7391736765963768,
        "ece": 0.20194885402917864
      }
    }
  },
  "training_history": [
    {
      "total_loss": 3.2520459116119698,
      "knn_loss": 0.49823718544422196,
      "contrastive_loss": 5.507617458854754,
      "entropy": 0
    },
    {
      "total_loss": 2.8856449078038797,
      "knn_loss": 0.47181964197109655,
      "contrastive_loss": 4.8276505273642,
      "entropy": 0
    },
    {
      "total_loss": 2.4203527022882834,
      "knn_loss": 0.20720207568296453,
      "contrastive_loss": 4.426301263042332,
      "entropy": 0
    },
    {
      "total_loss": 2.1932774917366578,
      "knn_loss": 0.0946485606050983,
      "contrastive_loss": 4.197257853045906,
      "entropy": 0
    },
    {
      "total_loss": 2.1023572892257847,
      "knn_loss": 0.05640212523261296,
      "contrastive_loss": 4.091910322916877,
      "entropy": 0
    },
    {
      "total_loss": 2.104562779062802,
      "knn_loss": 0.0356326053859954,
      "contrastive_loss": 4.137860322735973,
      "entropy": 0
    },
    {
      "total_loss": 2.0795903156713114,
      "knn_loss": 0.03490849678433433,
      "contrastive_loss": 4.089363643803547,
      "entropy": 0
    },
    {
      "total_loss": 2.037973550177112,
      "knn_loss": 0.019846325404173935,
      "contrastive_loss": 4.036254447760041,
      "entropy": 0
    },
    {
      "total_loss": 2.0153959866651556,
      "knn_loss": 0.01294481698135586,
      "contrastive_loss": 4.004902338244252,
      "entropy": 0
    },
    {
      "total_loss": 1.998866671139432,
      "knn_loss": 0.006677524759746205,
      "contrastive_loss": 3.9843782887016377,
      "entropy": 0
    },
    {
      "total_loss": 1.985211841838876,
      "knn_loss": 0.004296763585256317,
      "contrastive_loss": 3.961830156365621,
      "entropy": 0
    },
    {
      "total_loss": 1.9773287957476586,
      "knn_loss": 0.003105579586621595,
      "contrastive_loss": 3.948446426194968,
      "entropy": 0
    },
    {
      "total_loss": 1.9719148923441308,
      "knn_loss": 0.0021457067259032874,
      "contrastive_loss": 3.9395383707026848,
      "entropy": 0
    },
    {
      "total_loss": 1.9696840010967451,
      "knn_loss": 0.0013927616150185619,
      "contrastive_loss": 3.9365824915699124,
      "entropy": 0
    },
    {
      "total_loss": 1.9678269169994236,
      "knn_loss": 0.0009960432156726935,
      "contrastive_loss": 3.9336617484535137,
      "entropy": 0
    },
    {
      "total_loss": 1.9876622072200185,
      "knn_loss": 0.0008696649643177508,
      "contrastive_loss": 3.973585082083633,
      "entropy": 0
    },
    {
      "total_loss": 2.0134864664569343,
      "knn_loss": 0.008496955364760127,
      "contrastive_loss": 4.009978999796602,
      "entropy": 0
    },
    {
      "total_loss": 2.0101355781260226,
      "knn_loss": 0.009743715367596788,
      "contrastive_loss": 4.00078371873836,
      "entropy": 0
    },
    {
      "total_loss": 2.0054824880717956,
      "knn_loss": 0.007993164975148117,
      "contrastive_loss": 3.994978676137236,
      "entropy": 0
    },
    {
      "total_loss": 1.9987442321384077,
      "knn_loss": 0.007129259189691625,
      "contrastive_loss": 3.9832299419285095,
      "entropy": 0
    }
  ]
}