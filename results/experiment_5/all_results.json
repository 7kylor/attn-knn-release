{
  "config": {
    "seed": 42,
    "embed_dim": 256,
    "num_heads": 4,
    "epochs": 20,
    "k_train": 16,
    "k_eval": 16,
    "mixup_alpha": 0.4,
    "contrastive_weight": 0.5
  },
  "main_results": {
    "Uniform kNN": {
      "accuracy": 0.8682,
      "f1_macro": 0.8682025895685704,
      "nll": 2.053499218661048,
      "ece": 0.1297250213623047
    },
    "Distance kNN": {
      "accuracy": 0.8685,
      "f1_macro": 0.868501694885792,
      "nll": 2.0535052503882287,
      "ece": 0.10992854027748108
    },
    "Attn-KNN (Ours)": {
      "accuracy": 0.8685,
      "f1_macro": 0.8684525413157509,
      "nll": 2.053620890713714,
      "ece": 0.13002311201095582
    },
    "Attn-KNN + TTA": {
      "accuracy": 0.872,
      "f1_macro": 0.8726753811356958,
      "nll": 0.9674665646521682,
      "ece": 0.02832833333164452
    },
    "Attn-KNN + k-Ensemble": {
      "accuracy": 0.8683,
      "f1_macro": 0.8682514415473561,
      "nll": 2.0474277359712074,
      "ece": 0.1299452272713185
    },
    "CNN (Upper Bound)": {
      "accuracy": 0.9512,
      "f1_macro": 0.9511736770264099,
      "nll": 0.242275848099107,
      "ece": 0.06848827954977749
    }
  },
  "k_sweep": {
    "1": {
      "uniform": {
        "accuracy": 0.8682,
        "f1_macro": 0.8681893638564946,
        "nll": 2.1012064666469294,
        "ece": 0.13180000000000003
      },
      "distance": {
        "accuracy": 0.8682,
        "f1_macro": 0.8681893638564946,
        "nll": 2.1012064666469294,
        "ece": 0.13180000000000003
      },
      "attention": {
        "accuracy": 0.8682,
        "f1_macro": 0.8681893638564946,
        "nll": 2.1012064666469294,
        "ece": 0.13180000000000003
      }
    },
    "3": {
      "uniform": {
        "accuracy": 0.8684,
        "f1_macro": 0.8683869831327229,
        "nll": 2.0793698288125335,
        "ece": 0.1304666665315628
      },
      "distance": {
        "accuracy": 0.8684,
        "f1_macro": 0.8683869831327229,
        "nll": 2.079368229966976,
        "ece": 0.12486711770296094
      },
      "attention": {
        "accuracy": 0.8685,
        "f1_macro": 0.8684670977023631,
        "nll": 2.079359935329645,
        "ece": 0.13072571013569828
      }
    },
    "5": {
      "uniform": {
        "accuracy": 0.8683,
        "f1_macro": 0.868287514373075,
        "nll": 2.075439157732835,
        "ece": 0.13021999999284742
      },
      "distance": {
        "accuracy": 0.8683,
        "f1_macro": 0.868287514373075,
        "nll": 2.0754348723029654,
        "ece": 0.11972265952825549
      },
      "attention": {
        "accuracy": 0.8686,
        "f1_macro": 0.8685736317894609,
        "nll": 2.0751416893706796,
        "ece": 0.13035608060359957
      }
    },
    "10": {
      "uniform": {
        "accuracy": 0.8682,
        "f1_macro": 0.8682064010199564,
        "nll": 2.0604114222073817,
        "ece": 0.002150000149011612
      },
      "distance": {
        "accuracy": 0.8684,
        "f1_macro": 0.8683982955998288,
        "nll": 2.060416075654545,
        "ece": 0.10879447072148321
      },
      "attention": {
        "accuracy": 0.8682,
        "f1_macro": 0.8681344171843894,
        "nll": 2.0602516966027555,
        "ece": 0.13000611932277678
      }
    },
    "20": {
      "uniform": {
        "accuracy": 0.8683,
        "f1_macro": 0.8683032348186236,
        "nll": 2.045664111356354,
        "ece": 0.003300001639127731
      },
      "distance": {
        "accuracy": 0.8683,
        "f1_macro": 0.8683032348186236,
        "nll": 2.0456767468572443,
        "ece": 0.10240298039913179
      },
      "attention": {
        "accuracy": 0.8685,
        "f1_macro": 0.8684493838431762,
        "nll": 2.0459636718532273,
        "ece": 0.1295075715661049
      }
    },
    "50": {
      "uniform": {
        "accuracy": 0.868,
        "f1_macro": 0.8679876148507898,
        "nll": 2.032419240945128,
        "ece": 0.12958160641193392
      },
      "distance": {
        "accuracy": 0.868,
        "f1_macro": 0.8679876148507898,
        "nll": 2.032430766489722,
        "ece": 0.0916848424613476
      },
      "attention": {
        "accuracy": 0.8684,
        "f1_macro": 0.868314680855064,
        "nll": 2.0326887513777945,
        "ece": 0.12959738349318511
      }
    }
  },
  "noise_robustness": {
    "0.0": {
      "uniform": {
        "accuracy": 0.8682,
        "f1_macro": 0.8682025895685704,
        "nll": 2.053499218661048,
        "ece": 0.1297250213623047
      },
      "distance": {
        "accuracy": 0.8685,
        "f1_macro": 0.868501694885792,
        "nll": 2.0535052503882287,
        "ece": 0.10992854027748108
      },
      "attention": {
        "accuracy": 0.8685,
        "f1_macro": 0.8684525413157509,
        "nll": 2.053620890713714,
        "ece": 0.13002311201095582
      }
    },
    "0.1": {
      "uniform": {
        "accuracy": 0.8684,
        "f1_macro": 0.8684044703546961,
        "nll": 1.872326057924967,
        "ece": 0.06375623899698259
      },
      "distance": {
        "accuracy": 0.8685,
        "f1_macro": 0.8684954247858638,
        "nll": 1.8723530111249704,
        "ece": 0.06085588100552561
      },
      "attention": {
        "accuracy": 0.8682,
        "f1_macro": 0.8681301914826015,
        "nll": 1.8737022441992477,
        "ece": 0.0587845136374235
      }
    },
    "0.2": {
      "uniform": {
        "accuracy": 0.8683,
        "f1_macro": 0.8682948712921718,
        "nll": 1.7191771134970568,
        "ece": 0.09744999769926072
      },
      "distance": {
        "accuracy": 0.8685,
        "f1_macro": 0.8684850954765713,
        "nll": 1.7191677622809869,
        "ece": 0.09660389791429044
      },
      "attention": {
        "accuracy": 0.8685,
        "f1_macro": 0.8684426579581475,
        "nll": 1.719279922274451,
        "ece": 0.09194288346469404
      }
    },
    "0.3": {
      "uniform": {
        "accuracy": 0.8682,
        "f1_macro": 0.8681922827283367,
        "nll": 1.6432105706518891,
        "ece": 0.17394375048875807
      },
      "distance": {
        "accuracy": 0.8685,
        "f1_macro": 0.8684908263953245,
        "nll": 1.6432061359671872,
        "ece": 0.17424949688613411
      },
      "attention": {
        "accuracy": 0.868,
        "f1_macro": 0.8679257438412773,
        "nll": 1.6449312776308092,
        "ece": 0.17223007570505142
      }
    }
  },
  "training_history": [
    {
      "total_loss": 3.923845190362832,
      "knn_loss": 3.923845190362832,
      "contrastive_loss": 0,
      "entropy": 0
    },
    {
      "total_loss": 3.288734905498544,
      "knn_loss": 3.288734905498544,
      "contrastive_loss": 0,
      "entropy": 0
    },
    {
      "total_loss": 2.7055783247210314,
      "knn_loss": 2.7055783247210314,
      "contrastive_loss": 0,
      "entropy": 0
    },
    {
      "total_loss": 2.3068161059900656,
      "knn_loss": 2.3068161059900656,
      "contrastive_loss": 0,
      "entropy": 0
    },
    {
      "total_loss": 2.129473865646677,
      "knn_loss": 2.129473865646677,
      "contrastive_loss": 0,
      "entropy": 0
    },
    {
      "total_loss": 1.9934544575583075,
      "knn_loss": 1.9934544575583075,
      "contrastive_loss": 0,
      "entropy": 0
    },
    {
      "total_loss": 1.981755412730974,
      "knn_loss": 1.981755412730974,
      "contrastive_loss": 0,
      "entropy": 0
    },
    {
      "total_loss": 1.979150843374508,
      "knn_loss": 1.979150843374508,
      "contrastive_loss": 0,
      "entropy": 0
    },
    {
      "total_loss": 1.9770033654478407,
      "knn_loss": 1.9770033654478407,
      "contrastive_loss": 0,
      "entropy": 0
    },
    {
      "total_loss": 1.9769137999446122,
      "knn_loss": 1.9769137999446122,
      "contrastive_loss": 0,
      "entropy": 0
    },
    {
      "total_loss": 1.9731671576647414,
      "knn_loss": 1.9731671576647414,
      "contrastive_loss": 0,
      "entropy": 0
    },
    {
      "total_loss": 1.9744217850498318,
      "knn_loss": 1.9744217850498318,
      "contrastive_loss": 0,
      "entropy": 0
    },
    {
      "total_loss": 1.972272608698029,
      "knn_loss": 1.972272608698029,
      "contrastive_loss": 0,
      "entropy": 0
    },
    {
      "total_loss": 1.9744536151591034,
      "knn_loss": 1.9744536151591034,
      "contrastive_loss": 0,
      "entropy": 0
    },
    {
      "total_loss": 1.9733727666520582,
      "knn_loss": 1.9733727666520582,
      "contrastive_loss": 0,
      "entropy": 0
    },
    {
      "total_loss": 1.972644031662302,
      "knn_loss": 1.972644031662302,
      "contrastive_loss": 0,
      "entropy": 0
    },
    {
      "total_loss": 1.9732806264739675,
      "knn_loss": 1.9732806264739675,
      "contrastive_loss": 0,
      "entropy": 0
    },
    {
      "total_loss": 1.9738448968867666,
      "knn_loss": 1.9738448968867666,
      "contrastive_loss": 0,
      "entropy": 0
    },
    {
      "total_loss": 1.9730704076511343,
      "knn_loss": 1.9730704076511343,
      "contrastive_loss": 0,
      "entropy": 0
    },
    {
      "total_loss": 1.9733603184985131,
      "knn_loss": 1.9733603184985131,
      "contrastive_loss": 0,
      "entropy": 0
    }
  ]
}